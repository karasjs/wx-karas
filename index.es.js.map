{"version":3,"file":"index.es.js","sources":["src/index.js"],"sourcesContent":["import karas from 'karas';\nimport { version } from '../package.json';\n\nconst { mode, ca, util, inject, animate: { frame } } = karas;\n\nconst RootList = [];\n\nclass Root extends karas.Root {\n  appendTo(dom) {\n    RootList.push(this);\n    this.__dom = dom;\n    this.__isDestroyed = false;\n    this.__initProps();\n    let tagName = this.tagName;\n    let params = Object.assign({}, ca, this.props.contextAttributes);\n    if(tagName === 'canvas') {\n      this.__ctx = dom.getContext('2d');\n      this.__renderMode = mode.CANVAS;\n    }\n    else if(tagName === 'webgl') {\n      // 优先手动指定，再自动判断，最后兜底\n      let gl, webgl2 = this.props.webgl2;\n      if(!util.isNil(webgl2)) {\n        if(webgl2) {\n          gl = dom.getContext('webgl2', params);\n        }\n        if(!gl) {\n          gl = dom.getContext('webgl', params);\n        }\n        this.__ctx = gl;\n      }\n      else {\n        gl = this.__ctx = dom.getContext('webgl2', params)\n          || dom.getContext('webgl', params);\n      }\n      this.__initShader(gl);\n      this.__renderMode = mode.WEBGL;\n    }\n    this.draw(true);\n    if(this.__dom.__root && this.__dom.__root instanceof Root) {\n      this.__dom.__root.destroy();\n    }\n    this.__dom.__root = this;\n    frame.removeRoot(this);\n    frame.addRoot(this);\n  }\n\n  destroy() {\n    super.destroy();\n    let i = RootList.indexOf(this);\n    if(i > -1) {\n      RootList.splice(i, 1);\n    }\n  }\n}\n\n// Root引用指过来\nlet createVd = karas.createVd;\nkaras.createVd = function(tagName, props, children) {\n  if(['canvas', 'svg', 'webgl'].indexOf(tagName) > -1) {\n    return new Root(tagName, props, children);\n  }\n  return createVd(tagName, props, children);\n};\n\nif(typeof requestAnimationFrame === 'undefined') {\n  inject.requestAnimationFrame = function(cb) {\n    if(!cb || !RootList[0]) {\n      return;\n    }\n    return RootList[0].__dom.requestAnimationFrame(cb);\n  };\n\n  inject.cancelAnimationFrame = function(id) {\n    if(!RootList[0]) {\n      return;\n    }\n    return RootList[0].__dom.cancelAnimationFrame(id);\n  };\n}\n\nconst IMG = inject.IMG;\nconst INIT = inject.INIT;\nconst LOADING = inject.LOADING;\nconst LOADED = inject.LOADED;\nconst FONT = inject.FONT;\n\ninject.measureImg = function(url, cb) {\n  if(!RootList.length && !wx.createImage) {\n    return;\n  }\n  if(Array.isArray(url)) {\n    if(!url.length) {\n      return cb && cb();\n    }\n    let count = 0;\n    let len = url.length;\n    let list = [];\n    url.forEach((item, i) => {\n      inject.measureImg(item, function(cache) {\n        list[i] = cache;\n        if(++count === len) {\n          cb && cb(list);\n        }\n      });\n    });\n    return;\n  }\n  else if(!url || !util.isString(url)) {\n    inject.error('Measure img invalid: ' + url);\n    cb && cb({\n      state: LOADED,\n      success: false,\n      url,\n    });\n    return;\n  }\n  let cache = IMG[url] = IMG[url] || {\n    state: INIT,\n    task: [],\n  };\n  if(cache.state === LOADED) {\n    cb && cb(cache);\n  }\n  else if(cache.state === LOADING) {\n    cb && cache.task.push(cb);\n  }\n  else {\n    cache.state = LOADING;\n    cb && cache.task.push(cb);\n    let img;\n    if(wx.createImage) {\n      img = wx.createImage();\n    }\n    else {\n      img = RootList[0].__dom.createImage();\n    }\n    img.onload = function() {\n      cache.state = LOADED;\n      cache.success = true;\n      cache.width = img.width;\n      cache.height = img.height;\n      cache.source = img;\n      cache.url = url;\n      let list = cache.task.splice(0);\n      list.forEach(cb => cb(cache));\n    };\n    img.onerror = function(e) {\n      cache.state = LOADED;\n      cache.success = false;\n      cache.url = url;\n      let list = cache.task.splice(0);\n      list.forEach(cb => cb(cache));\n    };\n    img.src = url;\n  }\n};\n\ninject.isDom = function(o) {\n  return o && (o.tagName || o.createImage);\n}\n\nconst CANVAS = {};\n\nfunction offscreenCanvas(key, width, height, message, contextAttributes) {\n  let o;\n  if(!key) {\n    o = wx.createOffscreenCanvas ? wx.createOffscreenCanvas({ type: '2d', width, height }) : wx.createCanvas();\n  }\n  else if(!CANVAS[key]) {\n    o = CANVAS[key] = wx.createOffscreenCanvas ? wx.createOffscreenCanvas({ type: '2d', width, height }) : wx.createCanvas();\n  }\n  else {\n    o = CANVAS[key];\n  }\n  if(!wx.createOffscreenCanvas) {\n    o.width = width;\n    o.height = height;\n  }\n  let ctx = o.getContext('2d', contextAttributes);\n  if(!ctx) {\n    inject.error('Total canvas memory use exceeds the maximum limit');\n  }\n  return {\n    canvas: o,\n    ctx,\n    available: true,\n    release() {\n      ctx.globalAlpha = 1;\n      ctx.setTransform(1, 0, 0, 1, 0, 0);\n      ctx.clearRect(0, 0, width, height);\n      this.available = false;\n    },\n  };\n}\n\ninject.hasOffscreenCanvas = function(key) {\n  return key && CANVAS.hasOwnProperty(key);\n};\n\ninject.getOffscreenCanvas = function(width, height, key, message, contextAttributes) {\n  return offscreenCanvas(key, width, height, message, contextAttributes);\n};\n\ninject.loadFont = function(fontFamily, url, cb) {\n  if(!wx.loadFontFace) {\n    return;\n  }\n  if(util.isFunction(url)) {\n    cb = url;\n    url = fontFamily;\n  }\n  if(Array.isArray(url)) {\n    if(!url.length) {\n      return cb();\n    }\n    let count = 0;\n    let len = url.length;\n    let list = [];\n    url.forEach((item, i) => {\n      inject.loadFont(item.fontFamily, item.url, function(cache) {\n        list[i] = cache;\n        if(++count === len) {\n          cb(list);\n        }\n      });\n    });\n    return;\n  }\n  else if(!url || !util.isString(url)) {\n    inject.error('Load font invalid: ' + url);\n    cb && cb({\n      state: LOADED,\n      success: false,\n      url,\n    });\n    return;\n  }\n  if(!fontFamily) {\n    fontFamily = url;\n  }\n  let cache = FONT[url] = FONT[url] || {\n    state: INIT,\n    task: [],\n  };\n  if(cache.state === LOADED) {\n    cb && cb(cache);\n  }\n  else if(cache.state === LOADING) {\n    cb && cache.task.push(cb);\n  }\n  else {\n    cache.state = LOADING;\n    cb && cache.task.push(cb);\n    if(url instanceof ArrayBuffer) {\n      success(url);\n    }\n    else {\n      wx.loadFontFace({\n        family: fontFamily,\n        source: `url(\"${url}\")`,\n        success,\n        fail: error,\n      });\n    }\n    function success() {\n      cache.state = LOADED;\n      cache.success = true;\n      cache.url = url;\n      let list = cache.task.splice(0);\n      list.forEach(cb => cb(cache, ab));\n    }\n    function error() {\n      cache.state = LOADED;\n      cache.success = false;\n      cache.url = url;\n      let list = cache.task.splice(0);\n      list.forEach(cb => cb(cache));\n    }\n  }\n}\n\nkaras.wxVersion = version;\n\nexport default karas;\n"],"names":["mode","karas","ca","util","inject","frame","animate","RootList","Root","_karas$Root","_inherits","apply","arguments","_createClass","key","value","appendTo","dom","push","__dom","__isDestroyed","__initProps","tagName","params","Object","assign","props","contextAttributes","__ctx","getContext","__renderMode","CANVAS","gl","webgl2","isNil","__initShader","WEBGL","draw","__root","destroy","removeRoot","addRoot","_get","_getPrototypeOf","prototype","call","i","indexOf","splice","createVd","children","requestAnimationFrame","cb","cancelAnimationFrame","id","IMG","INIT","LOADING","LOADED","FONT","measureImg","url","length","wx","createImage","Array","isArray","count","len","list","forEach","item","cache","isString","error","state","success","task","img","onload","width","height","source","onerror","e","src","isDom","o","offscreenCanvas","message","createOffscreenCanvas","type","createCanvas","ctx","canvas","available","release","globalAlpha","setTransform","clearRect","hasOffscreenCanvas","hasOwnProperty","getOffscreenCanvas","loadFont","fontFamily","loadFontFace","isFunction","ab","ArrayBuffer","family","concat","fail","wxVersion","version"],"mappings":"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"}