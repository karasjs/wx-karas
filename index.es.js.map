{"version":3,"file":"index.es.js","sources":["src/index.js"],"sourcesContent":["import karas from 'karas';\nimport { version } from '../package.json';\n\nconst { mode, ca, util, inject } = karas;\n\nconst RootList = [];\n\nclass Root extends karas.Root {\n  appendTo(dom) {\n    RootList.push(this);\n    this.__dom = dom;\n    this.__isDestroyed = false;\n    this.__initProps();\n    let tagName = this.tagName;\n    let params = Object.assign({}, ca, this.props.contextAttributes);\n    if(tagName === 'canvas') {\n      this.__ctx = dom.getContext('2d');\n      this.__renderMode = mode.CANVAS;\n    }\n    else if(tagName === 'webgl') {\n      // 优先手动指定，再自动判断，最后兜底\n      let gl, webgl2 = this.props.webgl2;\n      if(!util.isNil(webgl2)) {\n        if(webgl2) {\n          gl = dom.getContext('webgl2', params);\n        }\n        if(!gl) {\n          gl = dom.getContext('webgl', params);\n        }\n        this.__ctx = gl;\n      }\n      else {\n        gl = this.__ctx = dom.getContext('webgl2', params)\n          || dom.getContext('webgl', params);\n      }\n      this.__initShader(gl);\n      this.__renderMode = mode.WEBGL;\n    }\n    this.draw(true);\n    if(this.__dom.__root && this.__dom.__root instanceof Root) {\n      this.__dom.__root.destroy();\n    }\n    this.__dom.__root = this;\n  }\n\n  destroy() {\n    super.destroy();\n    let i = RootList.indexOf(this);\n    if(i > -1) {\n      RootList.splice(i, 1);\n    }\n  }\n}\n\n// Root引用指过来\nlet createVd = karas.createVd;\nkaras.createVd = function(tagName, props, children) {\n  if(['canvas', 'svg', 'webgl'].indexOf(tagName) > -1) {\n    return new Root(tagName, props, children);\n  }\n  return createVd(tagName, props, children);\n};\n\nif(typeof requestAnimationFrame === 'undefined') {\n  inject.requestAnimationFrame = function(cb) {\n    if(!cb || !RootList[0]) {\n      return;\n    }\n    return RootList[0].__dom.requestAnimationFrame(cb);\n  };\n\n  inject.cancelAnimationFrame = function(id) {\n    if(!RootList[0]) {\n      return;\n    }\n    return RootList[0].__dom.cancelAnimationFrame(id);\n  };\n}\n\nconst IMG = inject.IMG;\nconst INIT = inject.INIT;\nconst LOADING = inject.LOADING;\nconst LOADED = inject.LOADED;\nconst FONT = inject.FONT;\n\ninject.measureImg = function(url, cb) {\n  if(!RootList.length && !wx.createImage) {\n    return;\n  }\n  if(Array.isArray(url)) {\n    if(!url.length) {\n      return cb && cb();\n    }\n    let count = 0;\n    let len = url.length;\n    let list = [];\n    url.forEach((item, i) => {\n      inject.measureImg(item, function(cache) {\n        list[i] = cache;\n        if(++count === len) {\n          cb && cb(list);\n        }\n      });\n    });\n    return;\n  }\n  else if(!url || !util.isString(url)) {\n    inject.error('Measure img invalid: ' + url);\n    cb && cb({\n      state: LOADED,\n      success: false,\n      url,\n    });\n    return;\n  }\n  let cache = IMG[url] = IMG[url] || {\n    state: INIT,\n    task: [],\n  };\n  if(cache.state === LOADED) {\n    cb && cb(cache);\n  }\n  else if(cache.state === LOADING) {\n    cb && cache.task.push(cb);\n  }\n  else {\n    cache.state = LOADING;\n    cb && cache.task.push(cb);\n    let img;\n    if(wx.createImage) {\n      img = wx.createImage();\n    }\n    else {\n      img = RootList[0].__dom.createImage();\n    }\n    img.onload = function() {\n      cache.state = LOADED;\n      cache.success = true;\n      cache.width = img.width;\n      cache.height = img.height;\n      cache.source = img;\n      cache.url = url;\n      let list = cache.task.splice(0);\n      list.forEach(cb => cb(cache));\n    };\n    img.onerror = function(e) {\n      cache.state = LOADED;\n      cache.success = false;\n      cache.url = url;\n      let list = cache.task.splice(0);\n      list.forEach(cb => cb(cache));\n    };\n    img.src = url;\n  }\n};\n\ninject.isDom = function(o) {\n  return o && (o.tagName || o.createImage);\n}\n\nconst CANVAS = {};\n\nfunction offscreenCanvas(key, width, height, message) {\n  let o;\n  if(!key) {\n    o = wx.createOffscreenCanvas ? wx.createOffscreenCanvas({ type: '2d', width, height }) : wx.createCanvas();\n  }\n  else if(!CANVAS[key]) {\n    o = CANVAS[key] = wx.createOffscreenCanvas ? wx.createOffscreenCanvas({ type: '2d', width, height }) : wx.createCanvas();\n  }\n  else {\n    o = CANVAS[key];\n  }\n  if(!wx.createOffscreenCanvas) {\n    o.width = width;\n    o.height = height;\n  }\n  let ctx = o.getContext('2d');\n  return {\n    canvas: o,\n    ctx,\n    available: true,\n    release() {\n      ctx.globalAlpha = 1;\n      ctx.setTransform(1, 0, 0, 1, 0, 0);\n      ctx.clearRect(0, 0, width, height);\n      this.available = false;\n    },\n  };\n}\n\ninject.hasOffscreenCanvas = function(key) {\n  return key && CANVAS.hasOwnProperty(key);\n};\n\ninject.getOffscreenCanvas = function(width, height, key, message) {\n  return offscreenCanvas(key, width, height, message);\n};\n\ninject.loadFont = function(fontFamily, url, cb) {\n  if(!wx.loadFontFace) {\n    return;\n  }\n  if(util.isFunction(url)) {\n    cb = url;\n    url = fontFamily;\n  }\n  if(Array.isArray(url)) {\n    if(!url.length) {\n      return cb();\n    }\n    let count = 0;\n    let len = url.length;\n    let list = [];\n    url.forEach((item, i) => {\n      inject.loadFont(item.fontFamily, item.url, function(cache) {\n        list[i] = cache;\n        if(++count === len) {\n          cb(list);\n        }\n      });\n    });\n    return;\n  }\n  else if(!url || !util.isString(url)) {\n    inject.error('Load font invalid: ' + url);\n    cb && cb({\n      state: LOADED,\n      success: false,\n      url,\n    });\n    return;\n  }\n  if(!fontFamily) {\n    fontFamily = url;\n  }\n  let cache = FONT[url] = FONT[url] || {\n    state: INIT,\n    task: [],\n  };\n  if(cache.state === LOADED) {\n    cb && cb(cache);\n  }\n  else if(cache.state === LOADING) {\n    cb && cache.task.push(cb);\n  }\n  else {\n    cache.state = LOADING;\n    cb && cache.task.push(cb);\n    if(url instanceof ArrayBuffer) {\n      success(url);\n    }\n    else {\n      wx.loadFontFace({\n        family: fontFamily,\n        source: `url(\"${url}\")`,\n        success,\n        fail: error,\n      });\n    }\n    function success() {\n      cache.state = LOADED;\n      cache.success = true;\n      cache.url = url;\n      let list = cache.task.splice(0);\n      list.forEach(cb => cb(cache, ab));\n    }\n    function error() {\n      cache.state = LOADED;\n      cache.success = false;\n      cache.url = url;\n      let list = cache.task.splice(0);\n      list.forEach(cb => cb(cache));\n    }\n  }\n}\n\nkaras.wxVersion = version;\n\nexport default karas;\n"],"names":["mode","karas","ca","util","inject","RootList","Root","dom","push","__dom","__isDestroyed","__initProps","tagName","params","Object","assign","props","contextAttributes","__ctx","getContext","__renderMode","CANVAS","gl","webgl2","isNil","__initShader","WEBGL","draw","__root","destroy","i","indexOf","splice","createVd","children","requestAnimationFrame","cb","cancelAnimationFrame","id","IMG","INIT","LOADING","LOADED","FONT","measureImg","url","length","wx","createImage","Array","isArray","count","len","list","forEach","item","cache","isString","error","state","success","task","img","onload","width","height","source","onerror","e","src","isDom","o","offscreenCanvas","key","message","createOffscreenCanvas","type","createCanvas","ctx","canvas","available","release","globalAlpha","setTransform","clearRect","hasOffscreenCanvas","hasOwnProperty","getOffscreenCanvas","loadFont","fontFamily","loadFontFace","isFunction","ab","ArrayBuffer","family","fail","wxVersion","version"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,IAAQA,IAAI,GAAuBC,KAAK,CAAhCD,IAAI;EAAEE,EAAE,GAAmBD,KAAK,CAA1BC,EAAE;EAAEC,IAAI,GAAaF,KAAK,CAAtBE,IAAI;EAAEC,MAAM,GAAKH,KAAK,CAAhBG,MAAM,CAAA;AAE9B,IAAMC,QAAQ,GAAG,EAAE,CAAA;AAAC,IAEdC,IAAI,gBAAA,UAAA,WAAA,EAAA;AAAA,EAAA,SAAA,CAAA,IAAA,EAAA,WAAA,CAAA,CAAA;AAAA,EAAA,SAAA,IAAA,GAAA;AAAA,IAAA,OAAA,WAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,IAAA,IAAA,CAAA;AAAA,GAAA;AAAA,EAAA,YAAA,CAAA,IAAA,EAAA,CAAA;AAAA,IAAA,GAAA,EAAA,UAAA;IAAA,KACR,EAAA,SAAA,QAAA,CAASC,GAAG,EAAE;AACZF,MAAAA,QAAQ,CAACG,IAAI,CAAC,IAAI,CAAC,CAAA;MACnB,IAAI,CAACC,KAAK,GAAGF,GAAG,CAAA;MAChB,IAAI,CAACG,aAAa,GAAG,KAAK,CAAA;MAC1B,IAAI,CAACC,WAAW,EAAE,CAAA;AAClB,MAAA,IAAIC,OAAO,GAAG,IAAI,CAACA,OAAO,CAAA;AAC1B,MAAA,IAAIC,MAAM,GAAGC,MAAM,CAACC,MAAM,CAAC,EAAE,EAAEb,EAAE,EAAE,IAAI,CAACc,KAAK,CAACC,iBAAiB,CAAC,CAAA;MAChE,IAAGL,OAAO,KAAK,QAAQ,EAAE;QACvB,IAAI,CAACM,KAAK,GAAGX,GAAG,CAACY,UAAU,CAAC,IAAI,CAAC,CAAA;AACjC,QAAA,IAAI,CAACC,YAAY,GAAGpB,IAAI,CAACqB,MAAM,CAAA;AACjC,OAAC,MACI,IAAGT,OAAO,KAAK,OAAO,EAAE;AAC3B;AACA,QAAA,IAAIU,EAAE;AAAEC,UAAAA,MAAM,GAAG,IAAI,CAACP,KAAK,CAACO,MAAM,CAAA;AAClC,QAAA,IAAG,CAACpB,IAAI,CAACqB,KAAK,CAACD,MAAM,CAAC,EAAE;AACtB,UAAA,IAAGA,MAAM,EAAE;YACTD,EAAE,GAAGf,GAAG,CAACY,UAAU,CAAC,QAAQ,EAAEN,MAAM,CAAC,CAAA;AACvC,WAAA;UACA,IAAG,CAACS,EAAE,EAAE;YACNA,EAAE,GAAGf,GAAG,CAACY,UAAU,CAAC,OAAO,EAAEN,MAAM,CAAC,CAAA;AACtC,WAAA;UACA,IAAI,CAACK,KAAK,GAAGI,EAAE,CAAA;AACjB,SAAC,MACI;UACHA,EAAE,GAAG,IAAI,CAACJ,KAAK,GAAGX,GAAG,CAACY,UAAU,CAAC,QAAQ,EAAEN,MAAM,CAAC,IAC7CN,GAAG,CAACY,UAAU,CAAC,OAAO,EAAEN,MAAM,CAAC,CAAA;AACtC,SAAA;AACA,QAAA,IAAI,CAACY,YAAY,CAACH,EAAE,CAAC,CAAA;AACrB,QAAA,IAAI,CAACF,YAAY,GAAGpB,IAAI,CAAC0B,KAAK,CAAA;AAChC,OAAA;AACA,MAAA,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,CAAA;AACf,MAAA,IAAG,IAAI,CAAClB,KAAK,CAACmB,MAAM,IAAI,IAAI,CAACnB,KAAK,CAACmB,MAAM,YAAYtB,IAAI,EAAE;AACzD,QAAA,IAAI,CAACG,KAAK,CAACmB,MAAM,CAACC,OAAO,EAAE,CAAA;AAC7B,OAAA;AACA,MAAA,IAAI,CAACpB,KAAK,CAACmB,MAAM,GAAG,IAAI,CAAA;AAC1B,KAAA;AAAC,GAAA,EAAA;AAAA,IAAA,GAAA,EAAA,SAAA;AAAA,IAAA,KAAA,EAED,SAAU,OAAA,GAAA;AACR,MAAA,IAAA,CAAA,eAAA,CAAA,IAAA,CAAA,SAAA,CAAA,EAAA,SAAA,EAAA,IAAA,CAAA,CAAA,IAAA,CAAA,IAAA,CAAA,CAAA;AACA,MAAA,IAAIE,CAAC,GAAGzB,QAAQ,CAAC0B,OAAO,CAAC,IAAI,CAAC,CAAA;AAC9B,MAAA,IAAGD,CAAC,GAAG,CAAC,CAAC,EAAE;AACTzB,QAAAA,QAAQ,CAAC2B,MAAM,CAACF,CAAC,EAAE,CAAC,CAAC,CAAA;AACvB,OAAA;AACF,KAAA;AAAC,GAAA,CAAA,CAAA,CAAA;AAAA,EAAA,OAAA,IAAA,CAAA;AAAA,CA5CgB7B,CAAAA,KAAK,CAACK,IAAI,CA+C7B,CAAA;AACA,IAAI2B,QAAQ,GAAGhC,KAAK,CAACgC,QAAQ,CAAA;AAC7BhC,KAAK,CAACgC,QAAQ,GAAG,UAASrB,OAAO,EAAEI,KAAK,EAAEkB,QAAQ,EAAE;AAClD,EAAA,IAAG,CAAC,QAAQ,EAAE,KAAK,EAAE,OAAO,CAAC,CAACH,OAAO,CAACnB,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE;IACnD,OAAO,IAAIN,IAAI,CAACM,OAAO,EAAEI,KAAK,EAAEkB,QAAQ,CAAC,CAAA;AAC3C,GAAA;AACA,EAAA,OAAOD,QAAQ,CAACrB,OAAO,EAAEI,KAAK,EAAEkB,QAAQ,CAAC,CAAA;AAC3C,CAAC,CAAA;AAED,IAAG,OAAOC,qBAAqB,KAAK,WAAW,EAAE;AAC/C/B,EAAAA,MAAM,CAAC+B,qBAAqB,GAAG,UAASC,EAAE,EAAE;IAC1C,IAAG,CAACA,EAAE,IAAI,CAAC/B,QAAQ,CAAC,CAAC,CAAC,EAAE;AACtB,MAAA,OAAA;AACF,KAAA;IACA,OAAOA,QAAQ,CAAC,CAAC,CAAC,CAACI,KAAK,CAAC0B,qBAAqB,CAACC,EAAE,CAAC,CAAA;GACnD,CAAA;AAEDhC,EAAAA,MAAM,CAACiC,oBAAoB,GAAG,UAASC,EAAE,EAAE;AACzC,IAAA,IAAG,CAACjC,QAAQ,CAAC,CAAC,CAAC,EAAE;AACf,MAAA,OAAA;AACF,KAAA;IACA,OAAOA,QAAQ,CAAC,CAAC,CAAC,CAACI,KAAK,CAAC4B,oBAAoB,CAACC,EAAE,CAAC,CAAA;GAClD,CAAA;AACH,CAAA;AAEA,IAAMC,GAAG,GAAGnC,MAAM,CAACmC,GAAG,CAAA;AACtB,IAAMC,IAAI,GAAGpC,MAAM,CAACoC,IAAI,CAAA;AACxB,IAAMC,OAAO,GAAGrC,MAAM,CAACqC,OAAO,CAAA;AAC9B,IAAMC,MAAM,GAAGtC,MAAM,CAACsC,MAAM,CAAA;AAC5B,IAAMC,IAAI,GAAGvC,MAAM,CAACuC,IAAI,CAAA;AAExBvC,MAAM,CAACwC,UAAU,GAAG,UAASC,GAAG,EAAET,EAAE,EAAE;EACpC,IAAG,CAAC/B,QAAQ,CAACyC,MAAM,IAAI,CAACC,EAAE,CAACC,WAAW,EAAE;AACtC,IAAA,OAAA;AACF,GAAA;AACA,EAAA,IAAGC,KAAK,CAACC,OAAO,CAACL,GAAG,CAAC,EAAE;AACrB,IAAA,IAAG,CAACA,GAAG,CAACC,MAAM,EAAE;MACd,OAAOV,EAAE,IAAIA,EAAE,EAAE,CAAA;AACnB,KAAA;IACA,IAAIe,KAAK,GAAG,CAAC,CAAA;AACb,IAAA,IAAIC,GAAG,GAAGP,GAAG,CAACC,MAAM,CAAA;IACpB,IAAIO,IAAI,GAAG,EAAE,CAAA;AACbR,IAAAA,GAAG,CAACS,OAAO,CAAC,UAACC,IAAI,EAAEzB,CAAC,EAAK;AACvB1B,MAAAA,MAAM,CAACwC,UAAU,CAACW,IAAI,EAAE,UAASC,KAAK,EAAE;AACtCH,QAAAA,IAAI,CAACvB,CAAC,CAAC,GAAG0B,KAAK,CAAA;AACf,QAAA,IAAG,EAAEL,KAAK,KAAKC,GAAG,EAAE;AAClBhB,UAAAA,EAAE,IAAIA,EAAE,CAACiB,IAAI,CAAC,CAAA;AAChB,SAAA;AACF,OAAC,CAAC,CAAA;AACJ,KAAC,CAAC,CAAA;AACF,IAAA,OAAA;AACF,GAAC,MACI,IAAG,CAACR,GAAG,IAAI,CAAC1C,IAAI,CAACsD,QAAQ,CAACZ,GAAG,CAAC,EAAE;AACnCzC,IAAAA,MAAM,CAACsD,KAAK,CAAC,uBAAuB,GAAGb,GAAG,CAAC,CAAA;IAC3CT,EAAE,IAAIA,EAAE,CAAC;AACPuB,MAAAA,KAAK,EAAEjB,MAAM;AACbkB,MAAAA,OAAO,EAAE,KAAK;AACdf,MAAAA,GAAG,EAAHA,GAAAA;AACF,KAAC,CAAC,CAAA;AACF,IAAA,OAAA;AACF,GAAA;EACA,IAAIW,KAAK,GAAGjB,GAAG,CAACM,GAAG,CAAC,GAAGN,GAAG,CAACM,GAAG,CAAC,IAAI;AACjCc,IAAAA,KAAK,EAAEnB,IAAI;AACXqB,IAAAA,IAAI,EAAE,EAAA;GACP,CAAA;AACD,EAAA,IAAGL,KAAK,CAACG,KAAK,KAAKjB,MAAM,EAAE;AACzBN,IAAAA,EAAE,IAAIA,EAAE,CAACoB,KAAK,CAAC,CAAA;AACjB,GAAC,MACI,IAAGA,KAAK,CAACG,KAAK,KAAKlB,OAAO,EAAE;IAC/BL,EAAE,IAAIoB,KAAK,CAACK,IAAI,CAACrD,IAAI,CAAC4B,EAAE,CAAC,CAAA;AAC3B,GAAC,MACI;IACHoB,KAAK,CAACG,KAAK,GAAGlB,OAAO,CAAA;IACrBL,EAAE,IAAIoB,KAAK,CAACK,IAAI,CAACrD,IAAI,CAAC4B,EAAE,CAAC,CAAA;AACzB,IAAA,IAAI0B,GAAG,CAAA;IACP,IAAGf,EAAE,CAACC,WAAW,EAAE;AACjBc,MAAAA,GAAG,GAAGf,EAAE,CAACC,WAAW,EAAE,CAAA;AACxB,KAAC,MACI;MACHc,GAAG,GAAGzD,QAAQ,CAAC,CAAC,CAAC,CAACI,KAAK,CAACuC,WAAW,EAAE,CAAA;AACvC,KAAA;IACAc,GAAG,CAACC,MAAM,GAAG,YAAW;MACtBP,KAAK,CAACG,KAAK,GAAGjB,MAAM,CAAA;MACpBc,KAAK,CAACI,OAAO,GAAG,IAAI,CAAA;AACpBJ,MAAAA,KAAK,CAACQ,KAAK,GAAGF,GAAG,CAACE,KAAK,CAAA;AACvBR,MAAAA,KAAK,CAACS,MAAM,GAAGH,GAAG,CAACG,MAAM,CAAA;MACzBT,KAAK,CAACU,MAAM,GAAGJ,GAAG,CAAA;MAClBN,KAAK,CAACX,GAAG,GAAGA,GAAG,CAAA;MACf,IAAIQ,IAAI,GAAGG,KAAK,CAACK,IAAI,CAAC7B,MAAM,CAAC,CAAC,CAAC,CAAA;AAC/BqB,MAAAA,IAAI,CAACC,OAAO,CAAC,UAAAlB,EAAE,EAAA;QAAA,OAAIA,EAAE,CAACoB,KAAK,CAAC,CAAA;OAAC,CAAA,CAAA;KAC9B,CAAA;AACDM,IAAAA,GAAG,CAACK,OAAO,GAAG,UAASC,CAAC,EAAE;MACxBZ,KAAK,CAACG,KAAK,GAAGjB,MAAM,CAAA;MACpBc,KAAK,CAACI,OAAO,GAAG,KAAK,CAAA;MACrBJ,KAAK,CAACX,GAAG,GAAGA,GAAG,CAAA;MACf,IAAIQ,IAAI,GAAGG,KAAK,CAACK,IAAI,CAAC7B,MAAM,CAAC,CAAC,CAAC,CAAA;AAC/BqB,MAAAA,IAAI,CAACC,OAAO,CAAC,UAAAlB,EAAE,EAAA;QAAA,OAAIA,EAAE,CAACoB,KAAK,CAAC,CAAA;OAAC,CAAA,CAAA;KAC9B,CAAA;IACDM,GAAG,CAACO,GAAG,GAAGxB,GAAG,CAAA;AACf,GAAA;AACF,CAAC,CAAA;AAEDzC,MAAM,CAACkE,KAAK,GAAG,UAASC,CAAC,EAAE;EACzB,OAAOA,CAAC,KAAKA,CAAC,CAAC3D,OAAO,IAAI2D,CAAC,CAACvB,WAAW,CAAC,CAAA;AAC1C,CAAC,CAAA;AAED,IAAM3B,MAAM,GAAG,EAAE,CAAA;AAEjB,SAASmD,eAAe,CAACC,GAAG,EAAET,KAAK,EAAEC,MAAM,EAAES,OAAO,EAAE;AACpD,EAAA,IAAIH,CAAC,CAAA;EACL,IAAG,CAACE,GAAG,EAAE;IACPF,CAAC,GAAGxB,EAAE,CAAC4B,qBAAqB,GAAG5B,EAAE,CAAC4B,qBAAqB,CAAC;AAAEC,MAAAA,IAAI,EAAE,IAAI;AAAEZ,MAAAA,KAAK,EAALA,KAAK;AAAEC,MAAAA,MAAM,EAANA,MAAAA;AAAO,KAAC,CAAC,GAAGlB,EAAE,CAAC8B,YAAY,EAAE,CAAA;AAC5G,GAAC,MACI,IAAG,CAACxD,MAAM,CAACoD,GAAG,CAAC,EAAE;AACpBF,IAAAA,CAAC,GAAGlD,MAAM,CAACoD,GAAG,CAAC,GAAG1B,EAAE,CAAC4B,qBAAqB,GAAG5B,EAAE,CAAC4B,qBAAqB,CAAC;AAAEC,MAAAA,IAAI,EAAE,IAAI;AAAEZ,MAAAA,KAAK,EAALA,KAAK;AAAEC,MAAAA,MAAM,EAANA,MAAAA;AAAO,KAAC,CAAC,GAAGlB,EAAE,CAAC8B,YAAY,EAAE,CAAA;AAC1H,GAAC,MACI;AACHN,IAAAA,CAAC,GAAGlD,MAAM,CAACoD,GAAG,CAAC,CAAA;AACjB,GAAA;AACA,EAAA,IAAG,CAAC1B,EAAE,CAAC4B,qBAAqB,EAAE;IAC5BJ,CAAC,CAACP,KAAK,GAAGA,KAAK,CAAA;IACfO,CAAC,CAACN,MAAM,GAAGA,MAAM,CAAA;AACnB,GAAA;AACA,EAAA,IAAIa,GAAG,GAAGP,CAAC,CAACpD,UAAU,CAAC,IAAI,CAAC,CAAA;EAC5B,OAAO;AACL4D,IAAAA,MAAM,EAAER,CAAC;AACTO,IAAAA,GAAG,EAAHA,GAAG;AACHE,IAAAA,SAAS,EAAE,IAAI;AACfC,IAAAA,OAAO,EAAG,SAAA,OAAA,GAAA;MACRH,GAAG,CAACI,WAAW,GAAG,CAAC,CAAA;AACnBJ,MAAAA,GAAG,CAACK,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;MAClCL,GAAG,CAACM,SAAS,CAAC,CAAC,EAAE,CAAC,EAAEpB,KAAK,EAAEC,MAAM,CAAC,CAAA;MAClC,IAAI,CAACe,SAAS,GAAG,KAAK,CAAA;AACxB,KAAA;GACD,CAAA;AACH,CAAA;AAEA5E,MAAM,CAACiF,kBAAkB,GAAG,UAASZ,GAAG,EAAE;AACxC,EAAA,OAAOA,GAAG,IAAIpD,MAAM,CAACiE,cAAc,CAACb,GAAG,CAAC,CAAA;AAC1C,CAAC,CAAA;AAEDrE,MAAM,CAACmF,kBAAkB,GAAG,UAASvB,KAAK,EAAEC,MAAM,EAAEQ,GAAG,EAAEC,OAAO,EAAE;EAChE,OAAOF,eAAe,CAACC,GAAG,EAAET,KAAK,EAAEC,MAAe,CAAC,CAAA;AACrD,CAAC,CAAA;AAED7D,MAAM,CAACoF,QAAQ,GAAG,UAASC,UAAU,EAAE5C,GAAG,EAAET,EAAE,EAAE;AAC9C,EAAA,IAAG,CAACW,EAAE,CAAC2C,YAAY,EAAE;AACnB,IAAA,OAAA;AACF,GAAA;AACA,EAAA,IAAGvF,IAAI,CAACwF,UAAU,CAAC9C,GAAG,CAAC,EAAE;AACvBT,IAAAA,EAAE,GAAGS,GAAG,CAAA;AACRA,IAAAA,GAAG,GAAG4C,UAAU,CAAA;AAClB,GAAA;AACA,EAAA,IAAGxC,KAAK,CAACC,OAAO,CAACL,GAAG,CAAC,EAAE;AACrB,IAAA,IAAG,CAACA,GAAG,CAACC,MAAM,EAAE;AACd,MAAA,OAAOV,EAAE,EAAE,CAAA;AACb,KAAA;IACA,IAAIe,KAAK,GAAG,CAAC,CAAA;AACb,IAAA,IAAIC,GAAG,GAAGP,GAAG,CAACC,MAAM,CAAA;IACpB,IAAIO,IAAI,GAAG,EAAE,CAAA;AACbR,IAAAA,GAAG,CAACS,OAAO,CAAC,UAACC,IAAI,EAAEzB,CAAC,EAAK;AACvB1B,MAAAA,MAAM,CAACoF,QAAQ,CAACjC,IAAI,CAACkC,UAAU,EAAElC,IAAI,CAACV,GAAG,EAAE,UAASW,KAAK,EAAE;AACzDH,QAAAA,IAAI,CAACvB,CAAC,CAAC,GAAG0B,KAAK,CAAA;AACf,QAAA,IAAG,EAAEL,KAAK,KAAKC,GAAG,EAAE;UAClBhB,EAAE,CAACiB,IAAI,CAAC,CAAA;AACV,SAAA;AACF,OAAC,CAAC,CAAA;AACJ,KAAC,CAAC,CAAA;AACF,IAAA,OAAA;AACF,GAAC,MACI,IAAG,CAACR,GAAG,IAAI,CAAC1C,IAAI,CAACsD,QAAQ,CAACZ,GAAG,CAAC,EAAE;AACnCzC,IAAAA,MAAM,CAACsD,KAAK,CAAC,qBAAqB,GAAGb,GAAG,CAAC,CAAA;IACzCT,EAAE,IAAIA,EAAE,CAAC;AACPuB,MAAAA,KAAK,EAAEjB,MAAM;AACbkB,MAAAA,OAAO,EAAE,KAAK;AACdf,MAAAA,GAAG,EAAHA,GAAAA;AACF,KAAC,CAAC,CAAA;AACF,IAAA,OAAA;AACF,GAAA;EACA,IAAG,CAAC4C,UAAU,EAAE;AACdA,IAAAA,UAAU,GAAG5C,GAAG,CAAA;AAClB,GAAA;EACA,IAAIW,KAAK,GAAGb,IAAI,CAACE,GAAG,CAAC,GAAGF,IAAI,CAACE,GAAG,CAAC,IAAI;AACnCc,IAAAA,KAAK,EAAEnB,IAAI;AACXqB,IAAAA,IAAI,EAAE,EAAA;GACP,CAAA;AACD,EAAA,IAAGL,KAAK,CAACG,KAAK,KAAKjB,MAAM,EAAE;AACzBN,IAAAA,EAAE,IAAIA,EAAE,CAACoB,KAAK,CAAC,CAAA;AACjB,GAAC,MACI,IAAGA,KAAK,CAACG,KAAK,KAAKlB,OAAO,EAAE;IAC/BL,EAAE,IAAIoB,KAAK,CAACK,IAAI,CAACrD,IAAI,CAAC4B,EAAE,CAAC,CAAA;AAC3B,GAAC,MACI;AAAA,IAAA,IAcMwB,OAAO,GAAhB,SAASA,OAAO,GAAG;MACjBJ,KAAK,CAACG,KAAK,GAAGjB,MAAM,CAAA;MACpBc,KAAK,CAACI,OAAO,GAAG,IAAI,CAAA;MACpBJ,KAAK,CAACX,GAAG,GAAGA,GAAG,CAAA;MACf,IAAIQ,IAAI,GAAGG,KAAK,CAACK,IAAI,CAAC7B,MAAM,CAAC,CAAC,CAAC,CAAA;AAC/BqB,MAAAA,IAAI,CAACC,OAAO,CAAC,UAAAlB,EAAE,EAAA;AAAA,QAAA,OAAIA,EAAE,CAACoB,KAAK,EAAEoC,EAAE,CAAC,CAAA;OAAC,CAAA,CAAA;KAClC,CAAA;AAAA,IAAA,IACQlC,KAAK,GAAd,SAASA,KAAK,GAAG;MACfF,KAAK,CAACG,KAAK,GAAGjB,MAAM,CAAA;MACpBc,KAAK,CAACI,OAAO,GAAG,KAAK,CAAA;MACrBJ,KAAK,CAACX,GAAG,GAAGA,GAAG,CAAA;MACf,IAAIQ,IAAI,GAAGG,KAAK,CAACK,IAAI,CAAC7B,MAAM,CAAC,CAAC,CAAC,CAAA;AAC/BqB,MAAAA,IAAI,CAACC,OAAO,CAAC,UAAAlB,EAAE,EAAA;QAAA,OAAIA,EAAE,CAACoB,KAAK,CAAC,CAAA;OAAC,CAAA,CAAA;KAC9B,CAAA;IA1BDA,KAAK,CAACG,KAAK,GAAGlB,OAAO,CAAA;IACrBL,EAAE,IAAIoB,KAAK,CAACK,IAAI,CAACrD,IAAI,CAAC4B,EAAE,CAAC,CAAA;IACzB,IAAGS,GAAG,YAAYgD,WAAW,EAAE;MAC7BjC,OAAO,CAACf,GAAG,CAAC,CAAA;AACd,KAAC,MACI;MACHE,EAAE,CAAC2C,YAAY,CAAC;AACdI,QAAAA,MAAM,EAAEL,UAAU;QAClBvB,MAAM,EAAA,QAAA,CAAA,MAAA,CAAUrB,GAAG,EAAI,KAAA,CAAA;AACvBe,QAAAA,OAAO,EAAPA,OAAO;AACPmC,QAAAA,IAAI,EAAErC,KAAAA;AACR,OAAC,CAAC,CAAA;AACJ,KAAA;AAeF,GAAA;AACF,CAAC,CAAA;AAEDzD,KAAK,CAAC+F,SAAS,GAAGC,OAAO"}